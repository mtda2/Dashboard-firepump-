<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î Fire Pump</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-bg: #f0fdf4; --secondary-bg: #d7f2f0; --text-dark: #004d40; --text-light: #00796b;
            --accent: #26a69a; --card-bg: rgba(255, 255, 255, 0.7); --color-ok: #2e7d32;
            --color-warning: #fbc02d; --color-danger: #d32f2f;
        }
        body { 
            font-family: 'Sarabun', sans-serif; background-color: var(--primary-bg);
            background-image: radial-gradient(at top left, var(--primary-bg), transparent), radial-gradient(at bottom right, var(--secondary-bg), transparent);
            background-repeat: no-repeat; background-attachment: fixed; color: var(--text-dark);
        }
        .text-header { 
            color: var(--text-dark); 
            text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
        }
        .glass-card { 
            background: var(--card-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-radius: 1.25rem; border: 1px solid rgba(255, 255, 255, 0.7); 
            box-shadow: 0 8px 32px rgba(0, 77, 64, 0.1), inset 0 1px 2px rgba(255,255,255,0.9);
            transition: all 0.3s ease;
        }
        .glass-card:hover { transform: translateY(-5px); box-shadow: 0 15px 45px rgba(0, 77, 64, 0.15), inset 0 1px 2px rgba(255,255,255,0.9); }
        .kpi-icon { 
            width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 12px; 
            font-size: 1.5rem; color: var(--text-dark); background: linear-gradient(135deg, rgba(255,255,255,0.5), rgba(255,255,255,0.2)); 
            border: 1px solid rgba(255,255,255,0.7);
        }
        .sticky-header { position: sticky; top: 0; background: rgba(240, 253, 244, 0.9); backdrop-filter: blur(10px); z-index: 10; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--primary-bg); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 200; transition: opacity 0.5s ease; }
        .loader { width: 60px; height: 60px; border-radius: 50%; border: 5px solid rgba(0, 121, 107, 0.2); border-top-color: var(--text-light); animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .custom-filter { position: relative; }
        .filter-button { background-color: rgba(255, 255, 255, 0.3); border: 1px solid rgba(0, 121, 107, 0.3); border-radius: 8px; color: var(--text-dark); padding: 0.5rem 1rem; width: 100%; text-align: left; }
        
        .filter-dropdown-list { 
            position: fixed;
            background: #f0fdf4; 
            border: 1px solid #b2dfdb; 
            backdrop-filter: blur(10px); 
            border-radius: 8px; 
            padding: 0.5rem; 
            max-height: 200px; 
            overflow-y: auto; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .filter-dropdown-list label { display: block; padding: 0.25rem 0.5rem; border-radius: 4px; cursor: pointer; color: var(--text-dark); white-space: nowrap;}
        .filter-dropdown-list label:hover { background-color: rgba(0, 121, 107, 0.1); }
        
        .details-row { display: none; }
        .details-cell { padding: 1rem; background-color: rgba(0, 121, 107, 0.03); }
        .details-grid { display: grid; grid-template-columns: 1fr; gap: 0.75rem; }
        .details-item { display: flex; justify-content: space-between; align-items: flex-start; padding-bottom: 0.75rem; border-bottom: 1px solid rgba(0, 121, 107, 0.1); flex-wrap: wrap; }
        .details-item:last-child { border-bottom: none; }
        .details-item .topic { font-weight: 500; color: var(--text-light); flex-basis: 100%; margin-bottom: 0.25rem;}
        .details-item .result { font-weight: 600; text-align: left; color: var(--text-dark); word-break: break-word; flex-basis: 100%; padding-left: 0.5rem; }
        
        @media (min-width: 640px) { 
            .details-grid { grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); }
            .details-item { flex-wrap: nowrap; align-items: center;}
            .details-item .topic { flex-basis: auto; margin-bottom: 0; }
            .details-item .result { text-align: right; padding-left: 0; }
        }
        
        .toggle-details, .ai-analyze-btn { cursor: pointer; color: var(--accent); font-weight: 600; background: none; border: none; padding: 4px 8px; border-radius: 6px; transition: background-color 0.2s; white-space: nowrap; }
        .toggle-details:hover, .ai-analyze-btn:hover { background-color: rgba(0, 121, 107, 0.1); }

        dialog { 
            border: none; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); 
            border-radius: 1.5rem; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            max-width: 95vw; width: 750px; max-height: 90vh;
            display: flex; flex-direction: column; padding: 0; 
            overflow: hidden;
        }
        @media (min-width: 640px) { dialog { border-radius: 2.5rem; } }
        
        dialog::backdrop { background: rgba(0, 0, 0, 0.35); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); z-index: 199;}
        
        .dialog-header { 
            display: flex; align-items: center; 
            border-bottom: 1px solid rgba(200, 220, 210, 0.8); 
            padding: 1.5rem 2rem; flex-shrink: 0;
        }
        .dialog-content { 
            flex-grow: 1; overflow-y: auto; padding: 1rem 2rem; min-height: 0;
        }
        
        .ai-avatar { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 3px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.15); flex-shrink: 0; }
        .header-gradient-text { background: linear-gradient(90deg, #00796b, #26a69a); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .ai-response-card { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.5); border-radius: 18px; padding: 1.5rem; margin-bottom: 1.2rem; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.09); border-left-width: 10px; }
        .ai-summary { border-left-color: #26a69a; }
        .ai-critical { border-left-color: #FF3B30; }
        .ai-warning { border-left-color: #FF9500; }
        .ai-recommendation { border-left-color: #34C759; }
        .ai-response-card h3 { font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem; color: #1f2937; display: flex; align-items: center; gap: 0.75rem; }
        .ai-response-card ul { list-style-type: none; padding-left: 0; }
        .ai-response-card li { margin-bottom: 1.2rem; padding-left: 2rem; position: relative; color: #333; line-height: 1.6; }
        .ai-response-card li::before { position: absolute; left: 0; top: 0px; font-size: 1.1rem; line-height: 1; }
        .ai-response-card.ai-critical li::before { content: 'üö®'; }
        .ai-response-card.ai-warning li::before { content: '‚ö†Ô∏è'; }
        .ai-response-card.ai-summary li::before { content: '‚ú®'; }
        .ai-response-card.ai-recommendation li::before { content: 'üí°'; }
        .engineering-note { font-size: 0.9rem; color: #4b5563; background-color: rgba(0,0,0,0.05); padding: 0.6rem 1rem; border-radius: 8px; margin-top: 0.75rem; display: block; border-left: 3px solid #9ca3af; line-height: 1.5; }
        .executive-summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;}
        .summary-item { background: rgba(255,255,255,0.5); padding: 1rem; border-radius: 12px; border: 1px solid rgba(255,255,255,0.7);}
        .summary-item .label { font-size: 0.9rem; color: var(--text-light); margin-bottom: 0.25rem;}
        .summary-item .value { font-size: 1.2rem; font-weight: 600; color: var(--text-dark);}
        .summary-item.clickable { cursor: pointer; transition: background-color 0.2s; }
        .summary-item.clickable:hover { background-color: rgba(0, 121, 107, 0.1); }
        .report-details-container {
            max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out;
            background: rgba(255, 255, 255, 0.4); border-radius: 12px; margin-top: 1rem;
        }
        .report-details-container.show { max-height: 500px; overflow-y: auto;}
        .report-details-list { list-style-type: none; padding: 1rem; margin: 0; }
        .report-details-list li {
            padding: 0.75rem; border-bottom: 1px solid rgba(0, 121, 107, 0.1); font-size: 0.9rem;
        }
        .report-details-list li:last-child { border-bottom: none; }
        .report-details-list .issue-date { font-weight: 600; color: var(--text-light); }
        .report-details-list .issue-message { margin-top: 0.25rem; }
    </style>
</head>
<body class="text-gray-800">

    <div id="loader-overlay" class="loading-overlay">
        <div class="loader"></div>
        <p id="loader-text" class="mt-6 text-xl font-semibold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Dashboard...</p>
    </div>
    
    <dialog id="aiDialog"></dialog>
    <dialog id="managementReportDialog"></dialog>

    <div class="container mx-auto p-4 lg:p-6">
        <header class="text-center mb-8">
             <div class="flex items-center justify-center gap-4 sm:gap-6 flex-wrap">
                <div>
                    <svg width="100" height="100" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="32" cy="32" r="29" stroke="#00796b" stroke-width="2.5" />
                        <path d="M32 50C22.0588 50 14 41.9411 14 32C14 24.5327 18.3553 18.0278 24.5 14.5" stroke="#26a69a" stroke-width="2.5" stroke-linecap="round"/>
                        <path d="M32.0011 11.0001L40.0469 36.52L44.8298 32.8365" stroke="#004d40" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M41 42.1C41 44.2422 39.2422 46 37.1 46C34.9578 46 33.2 44.2422 33.2 42.1C33.2 39.9578 37.1 35 37.1 35C37.1 35 41 39.9578 41 42.1Z" fill="#26a69a"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-4xl lg:text-5xl font-bold mb-2 text-header">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î Fire Pump</h1>
                    <p id="system-time" class="text-sm opacity-70"></p>
                </div>
            </div>
        </header>
        
        <div class="relative z-20">
            <div class="glass-card p-4 mb-8">
                <div class="flex flex-wrap items-center gap-4">
                    <div class="flex-grow min-w-[200px]"><label class="block text-sm font-medium mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ (‡∏û.‡∏®.):</label><div id="year-filter" class="custom-filter"></div></div>
                    <div class="flex-grow min-w-[200px]"><label class="block text-sm font-medium mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label><div id="month-filter" class="custom-filter"></div></div>
                    
                    <div class="flex-shrink-0 flex items-end gap-2 flex-wrap">
                        <button id="executive-report-btn" class="bg-white hover:bg-teal-50 text-teal-600 font-bold py-2 px-4 rounded-lg transition-colors shadow-sm hover:shadow-md flex items-center gap-2">
                            <i data-lucide="file-text" class="w-4 h-4"></i>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
                        </button>
                        <button id="reset-filter-btn" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-sm hover:shadow-md">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                        <button id="apply-filter-btn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-6 rounded-lg transition-colors shadow-sm hover:shadow-md">‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="dashboard-content" class="relative z-10 opacity-0 transition-opacity duration-500">
             <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="shield-check"></i></div><p class="text-sm mb-1 opacity-70">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö</p><p id="system-status" class="text-2xl font-bold"></p></div>
                <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="calendar-check"></i></div><p class="text-sm mb-1 opacity-70">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p><p id="last-inspection-date" class="text-2xl font-bold"></p></div>
                <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="calendar-clock"></i></div><p class="text-sm mb-1 opacity-70">‡πÅ‡∏ú‡∏ô PM ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p><p id="next-pm-date" class="text-2xl font-bold"></p></div>
                <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="alert-triangle"></i></div><p class="text-sm mb-1 opacity-70">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Issue</p><p id="issue-count" class="text-2xl font-bold"></p></div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="activity" class="mr-2"></i>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå (RPM)</h2><div id="engine-speed-chart"></div></div>
                <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="pie-chart" class="mr-2"></i>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</h2><div id="overview-chart"></div></div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="fuel" class="mr-2"></i>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</h2><div id="fuel-gauge-chart"></div></div>
                <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="thermometer" class="mr-2"></i>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</h2><div id="temp-gauge-chart"></div></div>
                <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="droplets" class="mr-2"></i>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥</h2><div id="pressure-gauge-chart"></div></div>
                <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="battery-charging" class="mr-2"></i>‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà</h2><div id="battery-gauge-chart"></div></div>
            </div>
            <div class="glass-card p-6" style="margin-bottom: 80px;">
                <h2 class="text-2xl font-semibold mb-6 flex items-center"><i data-lucide="history" class="mr-2"></i>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm"><thead class="text-xs uppercase sticky-header"><tr id="table-header"></tr></thead><tbody id="table-body" class="text-gray-700"></tbody></table>
                </div>
            </div>
        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby-MPG-LgjRv5W06FtSvckhVzeMbkUhKMr5iJVvdmFNwTZHbDp5pcX4vgD2ynrTk4BG/exec";
    let allRecords = [];
    let filteredRecords = [];
    const thaiMonths = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô","‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
    const domCache = {
        dashboardContent: document.getElementById('dashboard-content'),
        loaderOverlay: document.getElementById('loader-overlay'),
        loaderText: document.getElementById('loader-text'),
        aiDialog: document.getElementById('aiDialog'),
        managementReportDialog: document.getElementById('managementReportDialog')
    };
    
    domCache.aiDialog.addEventListener('close', () => { domCache.aiDialog.innerHTML = ''; });
    domCache.managementReportDialog.addEventListener('close', () => { domCache.managementReportDialog.innerHTML = ''; });

    // [REFACTORED] Un-minified for readability
    class DateHandler {
        static parseDate(dateString) {
            const trimmedString = String(dateString || "").trim();
            if (!trimmedString) return null;

            if (trimmedString.includes("T")) {
                const dateFromISO = new Date(trimmedString);
                return dateFromISO && !isNaN(dateFromISO.getTime()) ? dateFromISO : null;
            }

            const dmyMatch = trimmedString.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);
            if (dmyMatch) {
                const day = parseInt(dmyMatch[1], 10);
                const month = parseInt(dmyMatch[2], 10);
                let year = parseInt(dmyMatch[3], 10);
                if (year < 100) year += 2500;
                if (year > 1000) year -= 543; // Convert from BE to AD
                return new Date(year, month - 1, day);
            }
            
            const genericDate = new Date(trimmedString);
            return genericDate && !isNaN(genericDate.getTime()) ? genericDate : null;
        }

        static formatDate(dateObject) {
            if (!dateObject || isNaN(dateObject.getTime())) return "-";
            const day = String(dateObject.getDate()).padStart(2, "0");
            const month = String(dateObject.getMonth() + 1).padStart(2, "0");
            const year = (dateObject.getFullYear() + 543).toString().slice(-2);
            return `${day}/${month}/${year}`;
        }

        static addMonth(dateObject) {
            if (!dateObject || isNaN(dateObject.getTime())) return null;
            const newDate = new Date(dateObject);
            newDate.setMonth(newDate.getMonth() + 1);
            return newDate;
        }
    }

    // [REFACTORED] Un-minified for readability
    const abbreviateHeader = (header) => String(header).replace(/\s\(STD.*\)/, '').replace(/\s\/.*/, '').trim();
    const parseStd = (header) => {
        const stdMatch = String(header || '').trim().match(/STD\.\s?(.*)\)/);
        if (!stdMatch) return null;

        const stdText = stdMatch[1].trim();
        const minMatch = stdText.match(/‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤\s?(\d+(\.\d+)?)/);
        if (minMatch) return { type: 'min', value: parseFloat(minMatch[1]) };

        const rangeMatch = stdText.match(/(\d+(\.\d+)?)\s?-\s?(\d+(\.\d+)?)/);
        return rangeMatch ? { type: 'range', min: parseFloat(rangeMatch[1]), max: parseFloat(rangeMatch[3]) } : null;
    };
    
    // [REFACTORED] Un-minified for readability
    const checkValueAgainstStd = (value, stdRule) => {
        const valueString = String(value || '');
        if (!stdRule || valueString.trim() === '' || valueString.trim() === '-') return true;

        const abnormalKeywords = ['‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥', '‡πÑ‡∏°‡πà‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏ä‡∏≥‡∏£‡∏∏‡∏î', '‡∏ï‡πà‡∏≥', '‡∏£‡∏±‡πà‡∏ß'];
        if (abnormalKeywords.some(keyword => valueString.toLowerCase().includes(keyword))) return false;

        const normalKeywords = ['‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', '‡πÅ‡∏ô‡πà‡∏ô', '‡πÉ‡∏™', '‡πÑ‡∏°‡πà‡∏°‡∏µ'];
        if (normalKeywords.some(keyword => valueString.toLowerCase().includes(keyword))) return true;

        const parsedValue = parseFloat(valueString.replace(/,/g, ''));
        if (isNaN(parsedValue)) return true;

        switch (stdRule.type) {
            case 'range': return parsedValue >= stdRule.min && parsedValue <= stdRule.max;
            case 'min': return parsedValue >= stdRule.value;
            default: return true;
        }
    };

    function setupKpiCards(latest, headers) {
        const isReady = latest[headers.find(h => h.startsWith("Check All Safety Devices"))] === "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô";
        const statusElement = document.getElementById("system-status");
        statusElement.textContent = isReady ? "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" : "‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö";
        statusElement.style.color = isReady ? "var(--color-ok)" : "var(--color-danger)";
        
        const lastCheckDate = DateHandler.parseDate(latest.Actual);
        document.getElementById("last-inspection-date").textContent = DateHandler.formatDate(lastCheckDate);
        document.getElementById("next-pm-date").textContent = DateHandler.formatDate(DateHandler.addMonth(lastCheckDate));
        
        let issueCount = 0;
        const issueHeader = headers.find(h => h.startsWith("ISSUE"));
        const issueValue = latest[issueHeader] ? String(latest[issueHeader]).toLowerCase().trim() : "";
        if (issueValue && issueValue !== "‡πÑ‡∏°‡πà‡∏°‡∏µ") {
            issueCount++;
        }
        
        const issueCountElement = document.getElementById("issue-count");
        issueCountElement.textContent = issueCount;
        issueCountElement.style.color = issueCount > 0 ? "var(--color-danger)" : "var(--color-ok)";
    }
    
    function getGaugeStatus(value, type) {
        if (type === "temperature") {
            if (value > 100) return { color: "var(--color-danger)", status: "‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ" };
            if (value >= 80) return { color: "var(--color-ok)", status: "‡∏õ‡∏Å‡∏ï‡∏¥" };
            if (value >= 40) return { color: "var(--color-warning)", status: "‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå" };
            return { color: "var(--color-danger)", status: "‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥" };
        }
        if (type === "battery") {
            if (value > 15) return { color: "var(--color-danger)", status: "‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ" };
            if (value >= 12) return { color: "var(--color-ok)", status: "‡∏õ‡∏Å‡∏ï‡∏¥" };
            return { color: "var(--color-danger)", status: "‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î" };
        }
        return { color: null, status: "" };
    }
    
    function renderCharts(chartData, latest, headers, allData) {
        const chartOptions = {
            chart: { toolbar: { show: false }, zoom: { enabled: false }, background: 'transparent' },
            theme: { mode: 'light' },
            dataLabels: { enabled: false },
            stroke: { curve: 'smooth', width: 3 },
            grid: { borderColor: 'rgba(0,121,107,0.1)', strokeDashArray: 4 },
            tooltip: { theme: 'light' },
            xaxis: { labels: { style: { colors: '#004d40' } } },
            yaxis: { labels: { style: { colors: '#004d40' } } },
            legend: { labels: { colors: '#004d40' } },
            noData: { text: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ', align: 'center', verticalAlign: 'middle' }
        };
        const radialOptions = {
            chart: { type: 'radialBar', height: 250 },
            plotOptions: {
                radialBar: {
                    hollow: { size: '60%' },
                    dataLabels: {
                        name: { show: true, fontSize: '14px', offsetY: -10, color: 'rgba(0,77,64,0.6)' },
                        value: { offsetY: 5, color: '#004d40', fontSize: '24px' }
                    },
                    track: { background: 'rgba(0,121,107,0.1)' }
                }
            }
        };

        const createOrUpdateChart = (id, options) => {
            const chart = ApexCharts.getChartByID(id);
            if (chart) {
                chart.updateOptions(options);
            } else {
                new ApexCharts(document.querySelector(`#${id}`), options).render();
            }
        };

        const rpmKey = headers.find(h => h.toLowerCase().includes('engine speed'));
        if (rpmKey) {
            const std = parseStd(rpmKey);
            const seriesData = chartData.map(d => ({
                x: DateHandler.parseDate(d.Actual)?.getTime(),
                y: parseInt(String(d[rpmKey] || '').replace(/,/g, ''), 10) || null
            })).filter(i => i.x && i.y !== null);

            let annotations = {};
            if (std) {
                if (std.type === 'range') {
                    annotations.yaxis = [{ y: std.max, borderColor: '#f57c00', strokeDashArray: 2, label: { borderColor: '#f57c00', style: { color: '#fff', background: '#f57c00' }, text: `STD Max: ${std.max} RPM` } }, { y: std.min, borderColor: '#fbc02d', strokeDashArray: 2, label: { borderColor: '#fbc02d', style: { color: '#fff', background: '#fbc02d' }, text: `STD Min: ${std.min} RPM` } }];
                } else if (std.type === 'min') {
                    annotations.yaxis = [{ y: std.value, borderColor: '#f57c00', label: { borderColor: '#f57c00', style: { color: '#fff', background: '#f57c00' }, text: `STD: ${std.value} RPM` } }];
                }
            }
            
            createOrUpdateChart('engine-speed-chart', {
                ...chartOptions,
                series: [{ name: 'RPM', data: seriesData }],
                chart: { id: 'engine-speed-chart', type: 'area', height: 350 },
                xaxis: { ...chartOptions.xaxis, type: 'datetime' },
                colors: ['#00796b'],
                fill: { type: 'gradient', gradient: { shadeIntensity: 1, opacityFrom: 0.4, opacityTo: 0.1, stops: [0, 100] } },
                annotations: annotations
            });
        }

        let normal = 0, abnormal = 0;
        headers.filter(h => h.includes('(STD.')).forEach(k => {
            if (checkValueAgainstStd(latest[k], parseStd(k))) normal++;
            else abnormal++;
        });
        createOrUpdateChart('overview-chart', { ...chartOptions, series: [normal, abnormal], chart: { id: 'overview-chart', type: 'donut', height: 300 }, labels: ['‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö'], colors: ['#2e7d32', '#d32f2f'], theme: { mode: 'light' }, legend: { position: 'bottom' }, plotOptions: { pie: { donut: { labels: { show: true, total: { show: true, label: '‡∏£‡∏ß‡∏°', color: '#004d40' } } } } } });

        const findLastValidValue = (records, keyParts) => {
            const key = headers.find(h => keyParts.some(part => h.toLowerCase().includes(part)));
            if (!key) return 0;
            const record = records.find(r => r[key] != null && r[key] !== '' && !isNaN(parseFloat(String(r[key]).replace(/[^0-9.,-]+/g, ""))));
            return record ? parseFloat(String(record[key]).replace(/[^0-9.,-]+/g, "")) : 0
        };

        const createOrUpdateGauge = (id, keyParts, unit, defaultColor, records, type) => {
            const value = findLastValidValue(records, keyParts);
            const { color, status } = getGaugeStatus(value, type);
            createOrUpdateChart(id, { ...radialOptions, series: [value], chart: { ...radialOptions.chart, id: id }, plotOptions: { ...radialOptions.plotOptions, radialBar: { ...radialOptions.plotOptions.radialBar, dataLabels: { ...radialOptions.plotOptions.radialBar.dataLabels, name: { ...radialOptions.plotOptions.radialBar.dataLabels.name, show: !!status, text: status }, value: { ...radialOptions.plotOptions.radialBar.dataLabels.value, formatter: (v) => `${parseFloat(v).toFixed(1)}${unit}` } } } }, colors: [color || defaultColor] });
        };

        createOrUpdateGauge("fuel-gauge-chart", ["fuel tank"], '%', '#0288d1', allData);
        createOrUpdateGauge("temp-gauge-chart", ["cooling water temperature"], "¬∞C", '#f57c00', allData, 'temperature');
        createOrUpdateGauge("pressure-gauge-chart", ["‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥", "pressure"], " PSI", '#689f38', allData);
        createOrUpdateGauge("battery-gauge-chart", ["battery charging volt", "‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≤‡∏£‡πå‡∏à"], " V", '#fbc02d', allData, 'battery');
    }

    function populateHistoryTable(data,headers){const mainColumns=["Actual","‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô","‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö","ISSUE"];document.getElementById("table-header").innerHTML=mainColumns.map(colName=>`<th class="px-2 py-3 text-left font-semibold whitespace-nowrap text-sm">${abbreviateHeader(colName)}</th>`).join('')+'<th class="px-2 py-3 text-left font-semibold text-sm">Actions</th>';let tableHtml="";data.forEach((row,rowIndex)=>{tableHtml+=`<tr class="border-b border-gray-200 hover:bg-teal-50/50" data-row-index="${rowIndex}">`;mainColumns.forEach(colName=>{const headerKey=headers.find(h=>h.toLowerCase().startsWith(colName.toLowerCase()))||colName;let rawValue=row[headerKey];let formattedValue=null==rawValue?"":rawValue;"Actual"===colName&&(formattedValue=DateHandler.formatDate(DateHandler.parseDate(rawValue)));tableHtml+=`<td class="px-2 py-3 whitespace-nowrap text-sm">${formattedValue}</td>`});tableHtml+=`<td class="px-2 py-3 flex items-center gap-2"><button class="toggle-details" data-target="${rowIndex}">üìÑ ‡∏î‡∏π</button><button class="ai-analyze-btn" data-row-index="${rowIndex}">ü§ñ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button></td></tr>`;tableHtml+=`<tr class="details-row" id="details-${rowIndex}"><td colspan="${mainColumns.length+1}" class="details-cell"><div class="details-grid">`;headers.filter(header=>!mainColumns.some(colName=>header.toLowerCase().startsWith(colName.toLowerCase()))&&"Plan"!==header).forEach(header=>{const topic=abbreviateHeader(header);let result=row[header]||"-";["‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô","‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà","‡πÅ‡∏ú‡∏ô"].some(val=>topic.includes(val))&&DateHandler.parseDate(row[header])&&(result=DateHandler.formatDate(DateHandler.parseDate(row[header])));tableHtml+=`<div class="details-item"><span class="topic">${topic}</span><span class="result">${result}</span></div>`});tableHtml+="</div></td></tr>"});document.getElementById("table-body").innerHTML=tableHtml;document.querySelectorAll(".toggle-details").forEach(btn=>{btn.addEventListener("click",event=>{const targetIndex=event.target.dataset.target,detailsRow=document.getElementById(`details-${targetIndex}`);detailsRow&&("table-row"===detailsRow.style.display?(detailsRow.style.display="none",event.target.textContent="üìÑ ‡∏î‡∏π"):(detailsRow.style.display="table-row",event.target.textContent="üìÑ ‡∏ã‡πà‡∏≠‡∏ô"))})});document.querySelectorAll(".ai-analyze-btn").forEach(btn=>{btn.addEventListener("click",event=>{runAiAnalysis(parseInt(event.currentTarget.dataset.rowIndex,10))})})}

    // [FIX] This is the definitive, working version of the dropdown creator
    function createCheckboxFilter(containerId, options, type) {
        const container = document.getElementById(containerId);
        if (!container) return;

        const button = document.createElement('button');
        button.className = 'filter-button';
        button.textContent = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å${type}...`;
        container.innerHTML = '';
        container.appendChild(button);

        const stateContainer = document.createElement('div');
        stateContainer.style.display = 'none';
        container.appendChild(stateContainer);

        const updateButtonText = () => {
            const checked = Array.from(stateContainer.querySelectorAll('input:checked'));
            if (checked.length === 0) {
                button.textContent = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å${type}...`;
            } else if (checked.length === 1) {
                const selectedOption = options.find(opt => String(opt.value) === checked[0].value);
                button.textContent = selectedOption ? selectedOption.text : '1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';
            } else {
                button.textContent = `${checked.length} ${type === '‡∏õ‡∏µ' ? '‡∏õ‡∏µ' : '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'}‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å`;
            }
        };

        const closeAllDropdowns = () => {
            document.querySelectorAll('.filter-dropdown-list').forEach(list => list.remove());
            document.removeEventListener('click', closeAllDropdowns);
        };

        button.addEventListener('click', e => {
            e.stopPropagation();
            const wasOpen = document.querySelector(`.filter-dropdown-list[data-owner="${containerId}"]`);
            closeAllDropdowns();

            if (wasOpen) return;

            const list = document.createElement('div');
            list.className = 'filter-dropdown-list';
            list.dataset.owner = containerId;
            list.style.zIndex = '210';
            list.addEventListener('click', e => e.stopPropagation());

            options.forEach(opt => {
                const label = document.createElement('label');
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.value = opt.value;
                checkbox.className = 'mr-2 rounded text-teal-500 focus:ring-teal-400';
                if (stateContainer.querySelector(`input[value="${opt.value}"]:checked`)) {
                    checkbox.checked = true;
                }
                label.appendChild(checkbox);
                label.append(` ${opt.text}`);
                list.appendChild(label);
            });
            
            list.addEventListener('change', () => {
                const checkedInputs = Array.from(list.querySelectorAll('input:checked'));
                stateContainer.innerHTML = checkedInputs.map(cb => `<input type="checkbox" value="${cb.value}" checked>`).join('');
                updateButtonText();
            });

            document.body.appendChild(list);

            const rect = button.getBoundingClientRect();
            list.style.width = `${rect.width}px`;
            list.style.left = `${rect.left}px`;

            const spaceBelow = window.innerHeight - rect.bottom;
            const listHeight = list.offsetHeight > 200 ? 200 : list.offsetHeight;
            if (spaceBelow < listHeight + 20 && rect.top > listHeight) {
                list.style.bottom = `${window.innerHeight - rect.top + 4}px`;
            } else {
                list.style.top = `${rect.bottom + 4}px`;
            }
            
            setTimeout(() => document.addEventListener('click', closeAllDropdowns), 0);
        });
    }

    function populateFilters(records){const y=[...new Set(records.map(r=>DateHandler.parseDate(r.Actual).getFullYear()))].sort((a,b)=>b-a).map(y=>({value:y,text:y+543}));const m=thaiMonths.map((m,i)=>({value:i,text:m}));createCheckboxFilter('year-filter',y,'‡∏õ‡∏µ');createCheckboxFilter('month-filter',m,'‡πÄ‡∏î‡∏∑‡∏≠‡∏ô')}
    
    function getFilteredData(years, months) {
        return allRecords.filter(r => {
            const date = DateHandler.parseDate(r.Actual);
            if (!date) return false;
            const yearMatch = years.length === 0 || years.includes(date.getFullYear());
            const monthMatch = months.length === 0 || months.includes(date.getMonth());
            return yearMatch && monthMatch;
        });
    }

    function applyFilters() {
        const selectedYears = Array.from(document.querySelectorAll('#year-filter div[style*="display: none"] input:checked')).map(cb => parseInt(cb.value));
        const selectedMonths = Array.from(document.querySelectorAll('#month-filter div[style*="display: none"] input:checked')).map(cb => parseInt(cb.value));
        filteredRecords = getFilteredData(selectedYears, selectedMonths);
        renderDashboard(filteredRecords);
    }

    function renderDashboard(data) {
        if (!data || data.length === 0) {
            domCache.dashboardContent.innerHTML = `<div class="text-center text-xl glass-card p-8">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>`;
            domCache.dashboardContent.classList.remove('opacity-0');
            return;
        }
        if(!document.getElementById('system-status')) {
            domCache.dashboardContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="shield-check"></i></div><p class="text-sm mb-1 opacity-70">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö</p><p id="system-status" class="text-2xl font-bold"></p></div>
                    <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="calendar-check"></i></div><p class="text-sm mb-1 opacity-70">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p><p id="last-inspection-date" class="text-2xl font-bold"></p></div>
                    <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="calendar-clock"></i></div><p class="text-sm mb-1 opacity-70">‡πÅ‡∏ú‡∏ô PM ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p><p id="next-pm-date" class="text-2xl font-bold"></p></div>
                    <div class="glass-card p-6 text-center"><div class="kpi-icon mx-auto"><i data-lucide="alert-triangle"></i></div><p class="text-sm mb-1 opacity-70">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Issue</p><p id="issue-count" class="text-2xl font-bold"></p></div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="activity" class="mr-2"></i>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå (RPM)</h2><div id="engine-speed-chart"></div></div>
                    <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="pie-chart" class="mr-2"></i>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</h2><div id="overview-chart"></div></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="fuel" class="mr-2"></i>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</h2><div id="fuel-gauge-chart"></div></div>
                    <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="thermometer" class="mr-2"></i>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</h2><div id="temp-gauge-chart"></div></div>
                    <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="droplets" class="mr-2"></i>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥</h2><div id="pressure-gauge-chart"></div></div>
                    <div class="glass-card p-6"><h2 class="text-xl font-semibold mb-4 flex items-center"><i data-lucide="battery-charging" class="mr-2"></i>‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà</h2><div id="battery-gauge-chart"></div></div>
                </div>
                <div class="glass-card p-6" style="margin-bottom: 80px;">
                    <h2 class="text-2xl font-semibold mb-6 flex items-center"><i data-lucide="history" class="mr-2"></i>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</h2>
                    <div class="overflow-x-auto"><table class="w-full text-sm"><thead class="text-xs uppercase sticky-header"><tr id="table-header"></tr></thead><tbody id="table-body" class="text-gray-700"></tbody></table></div>
                </div>`;
        }
        
        const latest = data[0];
        const headers = Object.keys(latest);
        setupKpiCards(latest, headers);
        renderCharts(data.slice().reverse(), latest, headers, data);
        populateHistoryTable(data, headers);
        lucide.createIcons();
        domCache.dashboardContent.classList.remove('opacity-0');
    }
        
    const headerToEntryIdMap = {
        'Actual': 'entry.1632403651', '‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô': 'entry.1231391232', 'PLAN': 'entry.994147210', 'Lubricating Oil Level': 'entry.1618028324', 'Cooling Water Level': 'entry.14334317', 'Battery Distilled Water Level': 'entry.1091386807', 'Fuel Tank Level': 'entry.964120987', 'Fuel Oil Leaks': 'entry.323305993', 'Lubricating Oil Leaks': 'entry.1072480311', 'Cooling Water Leaks': 'entry.1607591057', 'Tightness Of Bolts And Nuts': 'entry.719816448', 'Tightness Of Electrical Terminal Connections': 'entry.737194412', 'Air Cleaner': 'entry.1182164809', 'Fuel Filter Element': 'entry.950885152', 'Check Water Suction Tube': 'entry.824942619', 'Jocky Pump Test': 'entry.1298699451', '‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ó‡πà‡∏≠‡∏™‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏±‡πä‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô': 'entry.170318696', '‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ó‡πà‡∏≠‡∏™‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏±‡πä‡∏°‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô': 'entry.835390568', 'V Belts Condition': 'entry.380068157', 'Running Hours': 'entry.693422880', 'Engine RPM': 'entry.1405771031', 'Lubricating Oil Pressure': 'entry.1301900075', 'Lubricating Oil Temperature': 'entry.1118394468', 'Cooling Water Pressure': 'entry.278367378', 'Cooling Water Temperature': 'entry.1127101964', '‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ó‡πà‡∏≠‡∏™‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô': 'entry.797055912', '‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏ó‡πà‡∏≠‡∏™‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏Ç‡∏ì‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô': 'entry.1506477567', '‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•': 'entry.1316882575', 'Check Vibrations': 'entry.628997006', 'Check All Moving Parts For Abnormal Sounds': 'entry.1209254361', 'Flow Switch': 'entry.950605992', 'General Cleaning': 'entry.1459189432', 'Battery Charging Volt': 'entry.1833812342', 'Test Battery': 'entry.1502505224', 'Change Ludricating Oil': 'entry.376703834', 'Change Ludricating Oil Filter': 'entry.550562469', 'Change Air Filter': 'entry.964740712', 'Inspection For Any Sign Of Wburnmarks': 'entry.1952860784', 'Check Status Of All Indication': 'entry.1304076428', 'Check For General Operation & Condition': 'entry.1601277291', 'Check Casing Condition': 'entry.851234898', 'Dedusting': 'entry.362638249', 'Body,Cubicle&Racking Cleaning': 'entry.1151340514', 'Insulation Resistance Test & Grounding Checked': 'entry.1956843408', 'Tightening Of All Electrical Connection': 'entry.1745325661', 'Lubricate Mechanical Parts': 'entry.1547716680', 'Check All Safety Devices': 'entry.498232465', 'Check Fuses & Protection Device': 'entry.1443945119', 'Tightening Busbar Supports': 'entry.614621971', 'Check Communication for Building Automation System': 'entry.569091221', 'Check Communication for RUUor DDC to Building Automation System and Cleaning': 'entry.673310831', 'Check Status Lamp Show for Annuciator Panel': 'entry.1022996900', 'Record Voltage': 'entry.209108764', 'ISSUE': 'entry.129342865', 'CONDITION': 'entry.690163791', 'HISTORY RECCORD': 'entry.788703385', 'V Belts Condition/‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡∏û‡∏≤‡∏ô': 'entry.764561274'
    };
    
    // [IMPROVEMENT] Added new rules for more comprehensive analysis
    const analysisRules = {
        'entry.1618028324':{label:'‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏•‡πà‡∏≠‡∏•‡∏∑‡πà‡∏ô',type:'equals',std:'‡∏ï‡πà‡∏≥',severity:'critical',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏•‡πà‡∏≠‡∏•‡∏∑‡πà‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏∂‡∏Å‡∏´‡∏£‡∏≠‡∏Ç‡∏≠‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏π‡∏Å‡∏™‡∏π‡∏ö, ‡πÅ‡∏ö‡∏£‡∏¥‡πà‡∏á) ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏ô‡πá‡∏≠‡∏Ñ‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏ñ‡∏≤‡∏ß‡∏£‡πÑ‡∏î‡πâ</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏•‡πà‡∏≠‡∏•‡∏∑‡πà‡∏ô‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡πÄ‡∏õ‡∏Ñ‡∏ú‡∏π‡πâ‡∏ú‡∏•‡∏¥‡∏ï‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö Full ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏≤‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏°</span>`},
        'entry.14334317':{label:'‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô',type:'equals',std:'‡∏ï‡πà‡∏≥',severity:'critical',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡πà‡∏≠‡πÄ‡∏¢‡πá‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏•‡∏î‡∏•‡∏á ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡πÄ‡∏Å‡∏¥‡∏î‡∏†‡∏≤‡∏ß‡∏∞ Overheat ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏ô‡∏≥‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏õ‡∏∞‡πÄ‡∏Å‡πá‡∏ô‡∏ù‡∏≤‡∏™‡∏π‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏ù‡∏≤‡∏™‡∏π‡∏ö‡πÇ‡∏Å‡πà‡∏á‡πÑ‡∏î‡πâ</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏´‡∏•‡πà‡∏≠‡πÄ‡∏¢‡πá‡∏ô (Coolant) ‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏î‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡πà‡∏≠‡∏¢‡∏≤‡∏á, ‡∏´‡∏°‡πâ‡∏≠‡∏ô‡πâ‡∏≥, ‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥</span>`},
        'entry.1091386807':{label:'‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà',type:'equals',std:'‡∏ï‡πà‡∏≥',severity:'critical',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÉ‡∏ô‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö Lower<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡πÅ‡∏ú‡πà‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏à‡∏∞‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏è‡∏¥‡∏Å‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡∏ã‡∏±‡∏•‡πÄ‡∏ü‡∏ï‡πÄ‡∏Å‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÅ‡∏ú‡πà‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏∏‡∏•‡∏î‡∏•‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏≤‡∏ß‡∏£ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏ô‡∏Ñ‡∏ß‡∏£</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏ö‡∏£‡∏¥‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πå (‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô) ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö Upper ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (Overcharging) ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏±‡πà‡∏ô‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡πÄ‡∏£‡πá‡∏ß</span>`},
        'entry.964120987':{label:'Fuel Tank Level',type:'less_than',std:50,severity:'warning',message:val=>`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á (‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ${val} %) ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏ï‡πà‡∏≥‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏∞‡∏Å‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡πâ‡∏ô‡∏ñ‡∏±‡∏á‡∏ñ‡∏π‡∏Å‡∏î‡∏π‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏Ñ‡∏ß‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 75% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏ñ‡∏±‡∏á‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>`},
        'entry.323305993':{label:'‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á',type:'equals',std:'‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•',severity:'critical',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á! ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏±‡∏Ñ‡∏Ñ‡∏µ‡∏†‡∏±‡∏¢‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÑ‡∏ü‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏™‡∏π‡∏á ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πà‡πÄ‡∏´‡∏ï‡∏∏</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ! ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏£‡∏±‡πà‡∏ß‡∏ï‡∏≤‡∏°‡∏ó‡πà‡∏≠‡∏ó‡∏≤‡∏á, ‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠, ‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡πä‡∏°‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á ‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</span>`},
        'entry.1072480311':{label:'‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏•‡πà‡∏≠‡∏•‡∏∑‡πà‡∏ô',type:'equals',std:'‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•',severity:'critical',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏°‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏•‡πà‡∏≠‡∏•‡∏∑‡πà‡∏ô<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏•‡πà‡∏≠‡∏•‡∏∑‡πà‡∏ô‡∏•‡∏î‡∏•‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏™‡πà‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏´‡∏•‡πà‡∏≠‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏≠‡∏≤‡∏à‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏° ‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏∞‡πÄ‡∏Å‡πá‡∏ô‡∏≠‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á, ‡∏ã‡∏µ‡∏•‡∏Ç‡πâ‡∏≠‡πÄ‡∏´‡∏ß‡∏µ‡πà‡∏¢‡∏á ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô</span>`},
        'entry.1607591057':{label:'‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô',type:'equals',std:'‡∏£‡∏±‡πà‡∏ß‡πÑ‡∏´‡∏•',severity:'critical',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡πà‡∏ß‡∏ã‡∏∂‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏•‡πà‡∏≠‡πÄ‡∏¢‡πá‡∏ô‡∏•‡∏î‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏†‡∏≤‡∏ß‡∏∞ Overheat ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡πà‡∏≠‡∏¢‡∏≤‡∏á, ‡∏´‡∏°‡πâ‡∏≠‡∏ô‡πâ‡∏≥, ‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥ ‡πÅ‡∏•‡∏∞‡∏à‡∏∏‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≠‡∏¢‡∏£‡∏±‡πà‡∏ß</span>`},
        'entry.719816448':{label:'‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏™‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏ô‡πä‡∏≠‡∏ï',type:'equals',std:'‡∏ô‡πá‡∏≠‡∏ï‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô',severity:'warning',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏û‡∏ö‡∏™‡∏•‡∏±‡∏Å‡πÄ‡∏Å‡∏•‡∏µ‡∏¢‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡πá‡∏≠‡∏ï‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡πÅ‡∏£‡∏á‡∏™‡∏±‡πà‡∏ô‡∏™‡∏∞‡πÄ‡∏ó‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πá‡∏≠‡∏ï‡∏Ñ‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡∏™‡πà‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏¢‡∏∂‡∏î‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô ‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏î‡∏±‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏à‡∏´‡∏•‡∏∏‡∏î‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡πÑ‡∏î‡πâ</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ô‡∏ô‡πá‡∏≠‡∏ï‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏ö‡∏¥‡∏î (Torque) ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏∏‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏Ñ‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ó‡πà‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á, ‡∏ó‡πà‡∏≠‡πÑ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢</span>`},
        'entry.737194412':{label:'‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏Ç‡∏±‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤',type:'equals',std:'‡∏Ç‡∏±‡πâ‡∏ß‡∏™‡∏≤‡∏¢‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô',severity:'critical',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏Ç‡∏±‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏±‡πâ‡∏ß‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà, ‡πÑ‡∏î‡∏ä‡∏≤‡∏£‡πå‡∏à, ‡πÑ‡∏î‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó) ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡∏™‡∏π‡∏á ‡∏ì ‡∏à‡∏∏‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å‡∏à‡∏ô‡∏≠‡∏≤‡∏à‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏â‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÑ‡∏´‡∏°‡πâ‡πÑ‡∏î‡πâ ‡∏≠‡∏µ‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÑ‡∏ü‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡∏±‡πâ‡∏ß‡∏™‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡∏±‡∏ô‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</span>`},
        'entry.1182164809':{label:'‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®',type:'equals',std:'‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏±‡∏ô',severity:'warning',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏î‡∏ï‡∏±‡∏ô<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏≤‡πÑ‡∏´‡∏°‡πâ‡πÑ‡∏î‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏™‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏ô‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏≤‡πÑ‡∏´‡∏°‡πâ‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏±‡∏ô‡∏î‡∏≥ ‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á ‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏ï‡∏Å</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡πÄ‡∏õ‡πà‡∏≤‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÉ‡∏´‡∏°‡πà‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</span>`},
        'entry.1833812342':{label:'‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà',type:'numeric_range',std:[13.5,14.8],severity:'warning',low_message:val=>`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà (‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ ${val} V) ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô (13.5V-14.8V)<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÑ‡∏ü‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÑ‡∏ü‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏°‡∏µ‡πÑ‡∏ü‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô (Voltage Regulator)</span>`,high_message:val=>`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà (‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ ${val} V) ‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (Overcharging)<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏±‡∏î, ‡∏ô‡πâ‡∏≥‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏î‡πÄ‡∏£‡πá‡∏ß, ‡πÅ‡∏ú‡πà‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏ö‡∏ß‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏ô‡∏Ñ‡∏ß‡∏£</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô (Voltage Regulator) ‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô</span>`},
        'entry.693422880':{label:'Running Hours', type:'running_hours', std:200, severity:'warning', message:val => `<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏° (${val} ‡∏ä‡∏°.) ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏∂‡∏á‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏∏‡∏Å 200 ‡∏ä‡∏°.) ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏à‡∏∞‡∏™‡∏∂‡∏Å‡∏´‡∏£‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏ú‡∏•‡∏¥‡∏ï‡∏Å‡∏≥‡∏´‡∏ô‡∏î</span>`},
        'entry.851234898':{label:'‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏†‡∏≤‡∏û‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå',type:'equals',std:'‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥',severity:'warning',message:`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏π‡πâ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏°‡∏µ‡∏™‡∏†‡∏≤‡∏û‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏ô‡∏¥‡∏°, ‡∏ö‡∏¥‡∏î‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß, ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡πÅ‡∏ï‡∏Å<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</strong> ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</span>`},
        'entry.1405771031':{label:'Engine RPM',type:'numeric_range',std:[2200,2400],severity:'warning',low_message:(val,std)=>`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå (${val} RPM) ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (${std[0]}-${std[1]} RPM)<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°:</strong> ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÑ‡∏ß‡πâ ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏•‡∏î‡∏•‡∏á ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏≠‡∏≤‡∏à‡∏ú‡∏•‡∏¥‡∏ï‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÑ‡∏ü‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏π‡∏ô Governor ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå</span>`,high_message:(val,std)=>`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå (${val} RPM) ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (${std[0]}-${std[1]} RPM)<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°:</strong> ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏∂‡∏Å‡∏´‡∏£‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß ‡∏≠‡∏≤‡∏à‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏à‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏ó‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏π‡∏ô Governor ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏≠‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå</span>`},
        'entry.797055912':{label:'‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',type:'numeric_range',std:[94,104],severity:'critical',low_message:(val,std)=>`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> Fire Pump ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà ${val} PSI ‡∏ã‡∏∂‡πà‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (${std[0]}-${std[1]} PSI)<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°:</strong> ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡∏ß‡∏¥‡∏Å‡∏§‡∏ï! ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥‡πÑ‡∏õ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ Fire Pump ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ä‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÑ‡∏´‡∏°‡πâ‡∏à‡∏£‡∏¥‡∏á ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á Pressure Switch ‡∏Ç‡∏≠‡∏á Fire Pump ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 99 PSI (‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á Jockey Pump) ‡πÇ‡∏î‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</span>`,high_message:(val,std)=>`<strong>‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:</strong> Fire Pump ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà ${val} PSI ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (${std[0]}-${std[1]} PSI)<span class="engineering-note"><strong>‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°:</strong> ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡∏ß‡∏¥‡∏Å‡∏§‡∏ï! ‡∏´‡∏≤‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á Jockey Pump) ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ Fire Pump ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏•‡∏¢ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Jockey Pump ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠</span><span class="engineering-note"><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡πâ‡∏á Pressure Switch ‡∏Ç‡∏≠‡∏á Fire Pump ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 99 PSI ‡πÇ‡∏î‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</span>`}};
    
    function generateAiAnalysis(data) {
        let criticalIssues = new Set();
        let warnings = new Set();
        for (const entryId in analysisRules) {
            const rule = analysisRules[entryId];
            const rawValue = data[entryId];
            if (rawValue === undefined || rawValue === '' || rawValue === null) continue;
            
            let issue = '';
            const numericValue = parseFloat(String(rawValue).replace(/,/g, ''));

            if (rule.type === 'less_than' && !isNaN(numericValue) && numericValue < rule.std) {
                issue = `<li>${rule.message(rawValue, rule.std)}</li>`;
            } else if (rule.type === 'numeric_range' && !isNaN(numericValue) && rule.std.length === 2) {
                if (numericValue < rule.std[0]) issue = `<li>${rule.low_message(rawValue, rule.std)}</li>`;
                else if (numericValue > rule.std[1]) issue = `<li>${rule.high_message(rawValue, rule.std)}</li>`;
            } else if (rule.type === 'equals' && String(rawValue).trim().toLowerCase() === rule.std.toLowerCase()) {
                issue = `<li>${rule.message}</li>`;
            } else if (rule.type === 'running_hours' && !isNaN(numericValue)) {
                if (numericValue > 0 && (numericValue % rule.std > rule.std - 50 || numericValue % rule.std === 0)) {
                    issue = `<li>${rule.message(rawValue)}</li>`;
                }
            }

            if (issue) {
                if (rule.severity === 'critical') criticalIssues.add(issue);
                else warnings.add(issue);
            }
        }
        
        const critArray = Array.from(criticalIssues);const warnArray = Array.from(warnings);let html = '';if (critArray.length > 0) {html += `<div class="ai-response-card ai-critical"><h3>üö® ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡πà‡∏á‡∏î‡πà‡∏ß‡∏ô</h3><ul>${critArray.join('')}</ul></div>`;}if (warnArray.length > 0) {html += `<div class="ai-response-card ai-warning"><h3>‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°</h3><ul>${warnArray.join('')}</ul></div>`;}if (critArray.length === 0 && warnArray.length === 0) {html = `<div class="ai-response-card ai-summary"><h3>‚úÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</h3><p>‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏° ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p></div>` + html;} else {html = `<div class="ai-response-card ai-summary"><h3>üìù ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</h3><p>‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö ${critArray.length} ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ß‡∏¥‡∏Å‡∏§‡∏ï ‡πÅ‡∏•‡∏∞ ${warnArray.length} ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p></div>` + html;}html += `<div class="ai-response-card ai-recommendation"><h3>üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h3><p>‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥ Logbook ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏° (Trend Analysis) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå (Predictive Maintenance) ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï</p></div>`;return html;
    }

    function runAiAnalysis(rowIndex) {
        const record = filteredRecords[rowIndex]; if (!record) return; const aiData = {}; const headers = Object.keys(record); for (const headerKey in headerToEntryIdMap) { const entryId = headerToEntryIdMap[headerKey]; const fullHeader = headers.find(h => h.startsWith(headerKey)); if (fullHeader && record[fullHeader] !== undefined) { aiData[entryId] = record[fullHeader]; } }
        const dialog = domCache.aiDialog;
        dialog.innerHTML = `<div class="dialog-header"> <svg class="ai-avatar" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="100" cy="100" r="100" fill="url(#avatar-bg-gradient)"/><g transform="translate(0, 10)"><path d="M85,150 L80,170 L120,170 L115,150 Z" fill="#4B5563"/><path d="M80,140 C80,155 120,155 120,140 L125,130 L75,130 Z" fill="#6B7280"/><path d="M60,135 L50,80 Q50,30 100,30 Q150,30 150,80 L140,135 Z" fill="url(#face-plate-gradient)" stroke="#4B5563" stroke-width="3"/><path d="M70 75 L80 65 L100 65 L105 75 L100 85 L80 85 Z" fill="#00796b" stroke="white" stroke-width="2"/><path d="M130 75 L120 65 L100 65 L95 75 L100 85 L120 85 Z" fill="#00796b" stroke="white" stroke-width="2" transform="matrix(-1, 0, 0, 1, 200, 0)"/><path d="M90,50 L110,50 M100,50 L100,40 M95,45 L105,45" stroke="#00796b" stroke-width="2.5" stroke-linecap="round"/><path d="M80,100 L120,100 L115,125 L85,125 Z" fill="#9CA3AF" stroke="#4B5563" stroke-width="2"/><line x1="85" y1="112" x2="115" y2="112" stroke="#6B7280" stroke-width="2"/></g><defs><linearGradient id="avatar-bg-gradient" x1="0" y1="0" x2="200" y2="200" gradientUnits="userSpaceOnUse"><stop stop-color="#00796b"/><stop offset="1" stop-color="#26a69a"/></linearGradient><linearGradient id="face-plate-gradient" x1="100" y1="20" x2="100" y2="180" gradientUnits="userSpaceOnUse"><stop stop-color="#F2F2F7"/><stop offset="1" stop-color="#E5E5EA"/></linearGradient></defs></svg> <h2 class="header-gradient-text text-xl md:text-2xl font-bold ml-4">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏≤‡∏Å AI</h2> <button onclick="this.closest('dialog').close()" aria-label="Close" class="ml-auto text-3xl font-bold text-gray-500 hover:text-gray-800">&times;</button> </div> <div class="dialog-content"> <div id="aiLoading" class="text-center py-8"><div class="loader mx-auto" style="width:40px; height:40px; border-width:4px;"></div><p class="text-gray-500 mt-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p></div> <div id="aiResult" class="hidden"></div> </div>`;
        dialog.showModal();
        setTimeout(() => { const analysisHTML = generateAiAnalysis(aiData); dialog.querySelector('#aiLoading').style.display = 'none'; const resultDiv = dialog.querySelector('#aiResult'); resultDiv.innerHTML = analysisHTML; resultDiv.classList.remove('hidden'); }, 500);
    }

    // [REWRITTEN] This function now generates a report based on main dashboard filters
    function generateExecutiveReport() {
        const dialog = domCache.managementReportDialog;
        const selectedYears = Array.from(document.querySelectorAll('#year-filter div[style*="display: none"] input:checked')).map(cb => parseInt(cb.value));
        const selectedMonths = Array.from(document.querySelectorAll('#month-filter div[style*="display: none"] input:checked')).map(cb => parseInt(cb.value));
        
        const reportData = getFilteredData(selectedYears, selectedMonths);

        let reportHTML = `<div class="dialog-header"> <i data-lucide="file-text" class="text-teal-600"></i> <h2 class="header-gradient-text text-xl md:text-2xl font-bold ml-4">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ</h2> <button onclick="this.closest('dialog').close()" aria-label="Close" class="ml-auto text-3xl font-bold text-gray-500 hover:text-gray-800">&times;</button> </div>`;

        if (reportData.length === 0) {
            reportHTML += `<div class="dialog-content"><p class="text-center text-red-500 py-8">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</p></div>`;
            dialog.innerHTML = reportHTML;
            dialog.showModal();
            lucide.createIcons();
            return;
        }

        const criticalDetails = [];
        const warningDetails = [];
        const problemFrequency = {};
        let numericTrends = { 'Cooling Water Temperature': [], 'Battery Charging Volt': [] };
        
        reportData.forEach(record => {
            const aiData = {};
            const headers = Object.keys(record);
            for (const headerKey in headerToEntryIdMap) {
                const entryId = headerToEntryIdMap[headerKey];
                const fullHeader = headers.find(h => h.startsWith(headerKey));
                if (fullHeader && record[fullHeader] !== undefined) aiData[entryId] = record[fullHeader];
            }
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = generateAiAnalysis(aiData);
            
            const collectIssues = (items, collection) => {
                items.forEach(item => {
                    const title = item.querySelector('strong')?.textContent.replace('‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢:', '').trim();
                    if (title) problemFrequency[title] = (problemFrequency[title] || 0) + 1;
                    collection.push({ date: record.Actual, operator: record['‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô'], issueHTML: item.innerHTML });
                });
            };
            collectIssues(tempDiv.querySelectorAll('.ai-critical li'), criticalDetails);
            collectIssues(tempDiv.querySelectorAll('.ai-warning li'), warningDetails);
            
            for (const key in numericTrends) {
                const fullHeader = Object.keys(record).find(h => h.startsWith(key));
                if (fullHeader) {
                    const value = parseFloat(String(record[fullHeader] || '').replace(/,/g, ''));
                    if (!isNaN(value)) numericTrends[key].push(value);
                }
            }
        });
        
        const getTrend = (arr) => {
            if (arr.length < 2) return '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠';
            const half = Math.ceil(arr.length / 2);
            const firstHalfAvg = arr.slice(0, half).reduce((a, b) => a + b, 0) / half;
            const secondHalfAvg = arr.slice(half).reduce((a, b) => a + b, 0) / (arr.length - half);
            if (secondHalfAvg > firstHalfAvg * 1.05) return '‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô üìà';
            if (secondHalfAvg < firstHalfAvg * 0.95) return '‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏•‡∏î‡∏•‡∏á üìâ';
            return '‡∏Ñ‡∏á‡∏ó‡∏µ‡πà üìä';
        };

        const sortedProblems = Object.entries(problemFrequency).sort(([, a], [, b]) => b - a).slice(0, 3);
        let periodText = '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
        if (selectedYears.length > 0) periodText = `‡∏õ‡∏µ ‡∏û.‡∏®. ${selectedYears.map(y => y + 543).join(', ')}`;
        if (selectedMonths.length > 0) {
            const monthText = ` ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${selectedMonths.map(m => thaiMonths[m]).join(', ')}`;
            periodText = (selectedYears.length > 0) ? periodText + monthText : monthText.trim();
        }

        reportHTML += `<div class="dialog-content">
            <p class="text-center text-gray-600 mb-4"><strong>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</strong> ${periodText}</p>
            <div class="executive-summary-grid">
                <div class="summary-item"><div class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div><div class="value">${reportData.length} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div></div>
                <div id="critical-summary" class="summary-item ${criticalDetails.length > 0 ? 'clickable' : ''}"><div class="label">‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ß‡∏¥‡∏Å‡∏§‡∏ï (‡∏£‡∏ß‡∏°)</div><div class="value" style="color:${criticalDetails.length > 0 ? 'var(--color-danger)' : 'var(--color-ok)'}">${criticalDetails.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
                <div id="warning-summary" class="summary-item ${warningDetails.length > 0 ? 'clickable' : ''}"><div class="label">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á (‡∏£‡∏ß‡∏°)</div><div class="value" style="color:${warningDetails.length > 0 ? 'var(--color-warning)' : 'var(--color-ok)'}">${warningDetails.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div></div>
            </div>
            <div id="critical-details" class="report-details-container"></div>
            <div id="warning-details" class="report-details-container"></div>
            <div class="ai-response-card ai-summary mt-4">
                <h3>üìä ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</h3>
                <ul class="list-none p-0 m-0 space-y-2">${Object.entries(numericTrends).map(([key, value]) => `<li class="flex justify-between"><span>${abbreviateHeader(key)}</span><span class="font-semibold">${getTrend(value)}</span></li>`).join('')}</ul>
            </div>
            <div class="ai-response-card ai-summary mt-4">
                <h3>‚ö†Ô∏è ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
                ${sortedProblems.length > 0 ? `<ol class="list-decimal pl-5">${sortedProblems.map(([key, value]) => `<li>${key} <strong>(${value} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</strong></li>`).join('')}</ol>` : '<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏ã‡πâ‡∏≥</p>'}
            </div>
        </div>`;
        
        dialog.innerHTML = reportHTML;
        dialog.showModal();
        lucide.createIcons();
        
        const toggleDetails = (type, details) => {
            const container = dialog.querySelector(`#${type}-details`);
            const otherContainer = dialog.querySelector(`#${type === 'critical' ? 'warning' : 'critical'}-details`);
            if (otherContainer) otherContainer.classList.remove('show');
            if (container.classList.contains('show')) {
                container.classList.remove('show');
                return;
            }
            let listHTML = `<ul class="report-details-list">${details.map(detail => `<li><div class="issue-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${DateHandler.formatDate(DateHandler.parseDate(detail.date))}</div><div class="issue-message">${detail.issueHTML}</div></li>`).join('')}</ul>`;
            container.innerHTML = listHTML;
            container.classList.add('show');
        };

        if (criticalDetails.length > 0) {
            dialog.querySelector('#critical-summary').addEventListener('click', () => toggleDetails('critical', criticalDetails));
        }
        if (warningDetails.length > 0) {
            dialog.querySelector('#warning-summary').addEventListener('click', () => toggleDetails('warning', warningDetails));
        }
    }
    
    function main() {
        let timeoutId;
        const fetchData = () => {
            clearTimeout(timeoutId); const controller = new AbortController(); const signal = controller.signal;
            timeoutId = setTimeout(() => { controller.abort(); handleError(new Error("‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ (Timeout) ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á")); }, 15000);

            fetch(WEB_APP_URL, { signal })
                .then(res => { if (!res.ok) throw new Error(`Server connection failed: ${res.status}`); return res.json(); })
                .then(jsonData => {
                    clearTimeout(timeoutId); const headers = jsonData[0], rows = jsonData.slice(1);
                    allRecords = rows.map(r => headers.reduce((obj, h, i) => { obj[h] = r[i]; return obj; }, {})).filter(r => r['Actual'] && DateHandler.parseDate(r['Actual']));
                    if (allRecords.length === 0) { throw new Error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô Google Sheet"); }
                    allRecords.sort((a, b) => (DateHandler.parseDate(b.Actual)?.getTime() || 0) - (DateHandler.parseDate(a.Actual)?.getTime() || 0));
                    if (!domCache.dashboardContent.classList.contains('loaded')) {
                        populateFilters(allRecords);
                        domCache.dashboardContent.classList.add('loaded');
                    }
                    applyFilters();
                    domCache.loaderOverlay.style.opacity = '0';
                    setTimeout(() => { domCache.loaderOverlay.style.display = 'none'; }, 500);
                    updateSystemTime();
                })
                .catch(handleError);
        };

        const handleError = (error) => { clearTimeout(timeoutId); console.error("Fatal Error:", error); domCache.loaderText.innerHTML = `<div class="text-center p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg"><strong>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:</strong><br>${error.message}<br><button onclick="location.reload()" class="mt-2 bg-red-500 text-white px-4 py-1 rounded">‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button></div>`; };
        const updateSystemTime=()=>{const e=new Date,t=e.toLocaleString("th-TH",{timeZone:"Asia/Bangkok",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});document.getElementById("system-time").textContent=`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${t}`};

        fetchData();
        document.getElementById('apply-filter-btn').addEventListener('click', applyFilters);
        document.getElementById('reset-filter-btn').addEventListener('click', () => {
            document.querySelectorAll('.custom-filter div[style*="display: none"]').forEach(container => container.innerHTML = '');
            document.querySelector('#year-filter .filter-button').textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ...';
            document.querySelector('#month-filter .filter-button').textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô...';
            applyFilters();
        });
        document.getElementById('executive-report-btn').addEventListener('click', generateExecutiveReport);
        setInterval(fetchData, 5 * 60 * 1000);
    }
    
    main();
    lucide.createIcons();
});
</script>
</body>
</html>
